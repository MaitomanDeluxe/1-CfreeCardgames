<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ポケカ開封シミュレーター</title>
  <style>
    body {
      margin: 0;
      overflow-x: hidden;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #fdfbfb, #ebedee);
    }

    h1 {
      text-align: center;
      margin-top: 20px;
      font-size: 2.5em;
    }

    #carousel-container {
      perspective: 1200px;
      width: 100%;
      height: 400px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #carousel {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 1s;
      position: relative;
    }

    .pack {
      width: 120px;
      height: 180px;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -90px 0 0 -60px;
      background-size: cover;
      background-position: center;
      transition: transform 0.5s ease, opacity 0.5s ease;
      cursor: pointer;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      border: 3px solid transparent;
    }

    .pack.selected {
      transform: scale(1.2);
      border-color: gold;
      z-index: 1000;
    }

    #open-button {
      display: none;
      margin: 30px auto;
      font-size: 22px;
      padding: 14px 28px;
      background: #0078ff;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    #card-area {
      display: none;
      margin-top: 50px;
      text-align: center;
    }

    .card {
      width: 260px;
      height: 360px;
      margin: 0 auto;
      background-size: cover;
      background-position: center;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>

<h1>ポケカ開封シミュレーター</h1>

<div id="carousel-container">
  <div id="carousel"></div>
</div>
<button id="open-button">このパックを開封！</button>

<div id="card-area">
  <h2>あなたのカード</h2>
  <div class="card" id="opened-card"></div>
</div>

<script>
  const carousel = document.getElementById('carousel');
  const openButton = document.getElementById('open-button');
  const cardArea = document.getElementById('card-area');
  const openedCard = document.getElementById('opened-card');

  const packImages = [
    'images/card-back-r.png',
    'images/card-back-b.png',
    'images/card-back-r.png',
    'images/card-back-b.png',
    'images/card-back-r.png',
    'images/card-back-b.png'
  ];

  let angle = 0;
  let selectedIndex = 0;

  function createCarousel() {
    const len = packImages.length;
    const degStep = 360 / len;

    for (let i = 0; i < len; i++) {
      const pack = document.createElement('div');
      pack.className = 'pack';
      pack.style.backgroundImage = `url(${packImages[i]})`;
      const theta = i * degStep;
      const radius = 300;
      const x = radius * Math.sin(theta * Math.PI / 180);
      const z = radius * Math.cos(theta * Math.PI / 180);
      pack.style.transform = `translateX(${x}px) translateZ(${z}px) rotateY(${theta}deg)`;
      pack.dataset.index = i;
      pack.addEventListener('click', () => selectPack(i));
      carousel.appendChild(pack);
    }

    updateSelection();
  }

  function rotateCarousel(dir) {
    const total = packImages.length;
    selectedIndex = (selectedIndex + dir + total) % total;
    angle = selectedIndex * -60;
    carousel.style.transform = `translateZ(-300px) rotateY(${angle}deg)`;
    updateSelection();
  }

  function updateSelection() {
    const packs = document.querySelectorAll('.pack');
    packs.forEach(p => p.classList.remove('selected'));
    const selected = packs[selectedIndex];
    if (selected) {
      selected.classList.add('selected');
    }
    openButton.style.display = 'block';
  }

  function selectPack(index) {
    selectedIndex = index;
    angle = selectedIndex * -60;
    carousel.style.transform = `translateZ(-300px) rotateY(${angle}deg)`;
    updateSelection();
  }

  openButton.addEventListener('click', () => {
    // フェードアウト
    document.getElementById('carousel-container').style.display = 'none';
    openButton.style.display = 'none';

    // カードを表示
    cardArea.style.display = 'block';

    // ランダムカード
    const randCard = Math.floor(Math.random() * 10) + 1;
    openedCard.style.backgroundImage = `url(images/${randCard}.png)`;
  });

  createCarousel();
</script>

</body>
</html>
